(()=>{"use strict";({575:function(){var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},t=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,l=e.length;n<r;n++,l++)e[l]=t[n];return e},n=document.getElementById("shipContainer"),r=!1,l=[];function o(e,t){var n=e,r=t;return{getName:function(){return r},getHP:function(){return n},fullHeal:function(){n=e},hit:function(){n-=1},isSunk:function(){return n<=0}}}function i(e,t){var n=[],l=parseInt(e,10);if(!r)for(var o=0;o<t;o+=1)n.push(l+o);if(r)for(o=l;o<l+10*t;o+=10)n.push(o);return n}function a(e){document.querySelector("h2").innerText=e}function u(e){!function(){for(var e=document.querySelectorAll(".grid"),t=0;t<e.length;t+=1)e[t].id=""+t}();var t=Array.from(Array(100).keys()),n=("player2"===e?t.map((function(e){return e+100})):t).map((function(e){return e.toString()})),l={carrier:o(5,"carrier"),battleship:o(4,"battleship"),cruiser:o(3,"cruiser"),submarine:o(3,"submarine"),destroyer:o(2,"destroyer")},i=[];return{name:e,fleet:l,fleetPlaced:i,board:n,placeFleet:function(e,t){var l=10*e.length;return!(!r&&e.some((function(t){return t%10==0&&t!==e[0]}))||r&&e[0]+l-10>100||e.some((function(e){return Number.isNaN(parseInt(n[e],10))}))||e.some((function(e){var t;return"•"===(null===(t=document.getElementById(e.toString()))||void 0===t?void 0:t.innerText)}))||(e.forEach((function(e){n[e]=t})),i.push(e.length),0))},gameOver:function(){return!!Object.values(l).every((function(e){return(0,e.isSunk)()}))}}}var d=u("player1"),c=u("player2");function s(){if(n){var e=null==n?void 0:n.getElementsByClassName("warship"),t=Array.prototype.slice.call(e);n.style.flexDirection="row"===n.style.flexDirection?"column":"row",t.forEach((function(e){e.className==="warship "+e.id?(e.classList.remove(e.id),e.classList.add(e.id+"Rotated"),e.style.margin="10px",r=!0):(e.classList.remove(e.id+"Rotated"),e.classList.add(e.id),r=!1)}))}}function f(e,t){return!!e.fleet[t].isSunk()}function v(e,t){return Number.isNaN(parseInt(e.board[t],10))?(e.fleet[e.board[t]].hit(),function(e,t){f(e,e.board[t])?a(e.name+"'s "+[e.board[t]]+" sinks"):a(e.name+"'s "+[e.board[t]]+" gets hit")}(e,t),function(e,t){for(var n,r=t.name,l=null===(n=document.getElementById(r+"SunkShip"))||void 0===n?void 0:n.firstElementChild;"black"===(null==l?void 0:l.style.color);)l=null==l?void 0:l.nextElementSibling;e&&(l.style.color="black")}(f(e,e.board[t]),e),e.board[t]="-3",function(e){var t="player1"===e.name?c:d;e.gameOver()&&(a(t.name+" wins!"),document.getElementById("content").style.display="none",document.getElementById("restart").style.display="block")}(e)):e.board[t]="-2",e.board[t]}function y(e,t){var n;if("•"===(null===(n=document.getElementById(t))||void 0===n?void 0:n.innerText))return!1;var r="player1"===e.name?c:d,o="player1"===e.name?parseInt(t,10)-100:parseInt(t,10);if(function(e,t,n){var r=document.getElementById(e);r&&(r.innerText="•",r.style.color=Number.isNaN(parseInt(t.board[n],10))?"red":"white")}(t,r,o),e===c){var i={index:0,result:0,ship:""};i.ship=r.board[o],i.result=v(r,o),i.index=o,l.push(i)}else v(r,o);return!0}function m(e,n){var l,o,a=[],d=u("player3");d.board=t([],e);for(var c=0;c<e.length;c+=1){for(var s=0,f=0;f<n.length;f+=1)d.placeFleet(i(e[c],n[f].getHP()),"2")&&(s+=1);"•"===(null===(l=document.getElementById(c.toString()))||void 0===l?void 0:l.innerText)&&(s=0),a.push(s)}for(r=!0,c=0;c<e.length;c+=1){var v=0;for(f=0;f<n.length;f+=1)d.placeFleet(i(e[c],n[f].getHP()),"2")&&(v+=1);"•"===(null===(o=document.getElementById(c.toString()))||void 0===o?void 0:o.innerText)&&(v=0),a[c]+=v}return r=!1,a}function p(e,t){var n=t.reduce((function(t,n,r){return n===(e-10).toString()||n===(e+10).toString()||n===(e-1).toString()||n===(e+1).toString()?t.concat(r.toString()):t}),[]),r=Math.floor(Math.random()*n.length);return 0===n.length?null:n[r]}function g(e,t){return e.findIndex((function(e){return e===t}))}function h(e){return l[l.length-e]?l[l.length-e]:null}var b=!1,E=[],S=Object.keys(d.fleet).map((function(e){return d.fleet[e]}));var x,I,B,k,N,O,A,w="",L="";function P(e){var t,n=e.target;w=n.id,null===(t=e.dataTransfer)||void 0===t||t.setData("text",null==n?void 0:n.className)}x=document.querySelectorAll(".warship"),I=document.querySelector(".mainBoard"),k=null==(B=document.getElementById("player2Board"))?void 0:B.querySelectorAll(".grid"),N=document.querySelector("button"),O=document.getElementById("restart"),A=!0,x.forEach((function(e){return e.addEventListener("dragstart",P)})),null==I||I.addEventListener("dragover",(function(e){return e.preventDefault()})),null==I||I.addEventListener("drop",(function(e){var t,n=e.target;d.placeFleet(i(n.id,null===(t=d.fleet[w])||void 0===t?void 0:t.getHP()),w)?(function(e){var t,n=e.currentTarget;L=n.id;var r=e.target,l=null===(t=e.dataTransfer)||void 0===t?void 0:t.getData("text");r.className+=" "+l}(e),A=!0):A=!1})),x.forEach((function(t){return t.addEventListener("dragend",(function(t){A&&(function(e){"player1MainBoard"===L&&(e.target.style.display="none",L="")}(t),function(){if(t=null==n?void 0:n.querySelectorAll(".warship"),Array.prototype.slice.call(t).every((function(e){return"none"===e.style.display}))){var t,l=document.getElementById("shipContainer"),o=document.getElementById("player2Board");l&&o&&(l.style.display="none",o.style.display="flex",function(t){for(var n=e({},t.fleet);5!==t.fleetPlaced.length;){var l=Object.values(n)[0];if(!l)return;var o=Math.floor(100*Math.random());o<51&&(r=!0),t.placeFleet(i(o.toString(),l.getHP()),l.getName())&&delete n[Object.keys(n)[0]],r=!1}}(c),a("Game starts"))}}())}))})),null==k||k.forEach((function(e){return e.addEventListener("click",(function(e){return function(e){y(d,function(e){var t=e.target;return parseInt(t.id,10).toString()}(e))&&y(c,function(){var e,t,n,r,l,o,i,a,u,c,s,f,v,y,x,I,B,k,N,O,A,w=d.board.map((function(e){return"-2"===e||"-3"===e?null:d.board.indexOf(e).toString()}));if(null===(t=d.fleet[null===(e=h(1))||void 0===e?void 0:e.ship])||void 0===t?void 0:t.isSunk()){var L=S.map((function(e){return e.getName()})).indexOf(null===(n=h(1))||void 0===n?void 0:n.ship),P=E.indexOf(h(1).ship);S.splice(L,1),E.splice(P,1),0===E.length&&(b=!1,h(1).result="-2")}var q=Math.max.apply(Math,m(w,S)),T=m(w,S).reduce((function(e,t,n){return t===q?e.concat(n):e}),[]),j=Math.floor(Math.random()*T.length);return b||(A=T[j]),"-3"===(null===(r=h(1))||void 0===r?void 0:r.result)&&(b=!0,E.every((function(e){return e!==h(1).ship}))&&E.push(h(1).ship),A=p(h(1).index,w)),b&&"-2"===(null===(l=h(1))||void 0===l?void 0:l.result)&&(A=p(h(2).index,w)),b&&"-2"===(null===(o=h(1))||void 0===o?void 0:o.result)&&"-2"===(null===(i=h(2))||void 0===i?void 0:i.result)&&(A=p(h(3).index,w)),b&&"-2"===(null===(a=h(1))||void 0===a?void 0:a.result)&&"-2"===(null===(u=h(2))||void 0===u?void 0:u.result)&&"-2"===(null===(c=h(3))||void 0===c?void 0:c.result)&&(A=p(h(4).index,w)),b&&"-3"===(null===(s=h(1))||void 0===s?void 0:s.result)&&"-2"===(null===(f=h(2))||void 0===f?void 0:f.result)&&(A=p(h(1).index,w)),b&&"-2"===(null===(v=h(1))||void 0===v?void 0:v.result)&&"-3"===(null===(y=h(2))||void 0===y?void 0:y.result)&&"-3"===(null===(x=h(3))||void 0===x?void 0:x.result)&&(A=g(d.board,h(2).ship)),b&&"-3"===(null===(I=h(1))||void 0===I?void 0:I.result)&&"-3"===(null===(B=h(2))||void 0===B?void 0:B.result)&&(A=g(d.board,h(1).ship)),-1===A&&(A=p(h(2),w)),E.length>0&&"-2"===(null===(k=h(1))||void 0===k?void 0:k.result)&&"-2"===(null===(N=h(2))||void 0===N?void 0:N.result)&&"-2"===(null===(O=h(3))||void 0===O?void 0:O.result)&&(A=g(d.board,E[0])),A&&-1!==A||(A=T[j]),A.toString()}())}(e)}))})),null==N||N.addEventListener("click",s),null==O||O.addEventListener("click",(function(){for(var e=0;e<d.board.length;e+=1)d.board[e]=e.toString(),c.board[e]=(e+100).toString();Object.values(d.fleet).forEach((function(e){return e.fullHeal()})),Object.values(c.fleet).forEach((function(e){return e.fullHeal()})),d.fleetPlaced=[],c.fleetPlaced=[],b=!1,E=[],S=Object.keys(d.fleet).map((function(e){return d.fleet[e]})),document.querySelectorAll(".grid").forEach((function(e){e.className="grid",e.style.color="none",e.innerText=""})),document.querySelectorAll(".warship").forEach((function(e){e.style.display="block"})),document.querySelectorAll(".life").forEach((function(e){e.style.color="red"})),"row"===document.getElementById("shipContainer").style.flexDirection&&s(),a("Place your ships"),document.getElementById("content").style.display="flex",document.getElementById("shipContainer").style.display="flex",document.getElementById("player2Board").style.display="none",document.getElementById("restart").style.display="none"}))}})[575]()})();
//# sourceMappingURL=main.js.map